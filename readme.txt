                    ==============================
                          BatchBuilder v1.0
                            (c) 2018 Ivanq
                    ==============================

BatchBuilder - система сборки BAT/CMD файлов.


                    ------------------------------
                           Рабочие примеры
                    ------------------------------

С BatchCompiler поставляются примеры, названные как src-admin, src-alert и так далее. Для их запуска переименуйте папку в src, запустите build.cmd, а затем dist\bootstrap.cmd.


                    ------------------------------
                         Пример использования
                    ------------------------------

Начальные действия:
1. Копируем build.cmd и папку compiler куда-нибудь (например, в batch_test).
2. Создаем папку src и кидаем в нее файл entry.cmd. entry.cmd - ваш BAT.

После изменений
1. Запускаем build.cmd.
2. Появляется папку dist со скриптом bootstrap.cmd, запускаем его.


                    ------------------------------
                         Настройка "под себя"
                    ------------------------------

Для управления BatchBuilder в папке src можно создать файл build.ini. Имеются следующие опции:

1. entry=<filename>
   Значение по умолчанию: entry.cmd

   Скрипт, который будет запускаться при старте.

2. delete_compiled=<yes/no>
   Значение по умолчанию: yes

   Удалять ли скомпилированные BAT-файлы. Если выбрано no, скомпилированный код будет храниться в папке compiler\compiled.

3. compile_if=<rules>
   Значение по умолчанию: ~-4 .cmd,~-4 .bat

   Определяет, какие файлы будут обработаны компилятором BatchBuilder.

   Набор правил разделяется запятой. Сами же правила (~-4 .cmd и ~-4 .bat) делятся на ключ (~-4) и значение (.cmd и .bat).

   Если ключ начинается с тильды (~), а следующее за ней число - отрицательное (-4), то будут учитываться последние -n знаков (4). Если число положительное, будут учитываться все знаки, кроме первых n. Затем знаки сравниваются со значением.

   Если ключ не начинается с тильды, то это правило замены. Например, ключ a=b означает "заменить все a на b и затем сравнить со значением".

   Пример:
    ~-4 .cmd,~-4 .bat
    Обрабатывать файлы, у которых последние 4 символа - .cmd или .bat (то есть, имеют расширение cmd или bat).

   Пример:
    o=a hello.bat
    Обрабатывать файлы, имя которых равно hello.bat или hella.bat.


                    ------------------------------
                       Компилятор BatchBuilder
                    ------------------------------

Для упрощения работы BatchBuilder представляет возможность создания модулей. Модуль - обычный BAT-файл. Пример модуля:

+------------------------------------------------+
| hi.bat                                         |
+------------------------------------------------+
| export say_hello                               |
|  echo Hello                                    |
| end export                                     |
+------------------------------------------------+

Сохраним его в папку src. Теперь напишем скрипт, использующий say_hello:

+------------------------------------------------+
| entry.cmd                                      |
+------------------------------------------------+
| import say_hello                               |
+------------------------------------------------+

Компилятор BatchCompiler заменит "import say_hello" на вызов "echo Hello".


                    ------------------------------
                          Аргументы методов
                    ------------------------------

При вызове "import say_hello" мы могли передать дополнительные данные - например, имя:

+------------------------------------------------+
| entry.cmd                                      |
+------------------------------------------------+
| import say_hello Kirill                        |
| import say_hello Vanya                         |
+------------------------------------------------+

В таком случае первое переданное значение будет доступно как %1, второе - как %2 и так далее.

+------------------------------------------------+
| hi.bat                                         |
+------------------------------------------------+
| export say_hello                               |
|  echo Hello, %1!                               |
| end export                                     |
+------------------------------------------------+


Модули могут быть полезны для выполнения рутинных операция, например, запроса на удаление папки.

+------------------------------------------------+
| delete.cmd                                     |
+------------------------------------------------+
| export delete_dir                              |
|  set /p agree=Do you want to delete %1?        |
|  if "%agree%" == "yes" (                       |
|   rmdir /S /Q %1                               |
|  )                                             |
| end export                                     |
+------------------------------------------------+

+------------------------------------------------+
| entry.cmd                                      |
+------------------------------------------------+
| import delete_dir Documents                    |
| import delete_dir Desktop                      |
| import delete_dir Pictures                     |
| import delete_dir Music                        |
+------------------------------------------------+